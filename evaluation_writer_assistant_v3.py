
[...truncated to save space... this includes all the same code from previous step above...]
